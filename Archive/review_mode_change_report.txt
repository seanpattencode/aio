CHANGE REPORT: Review Mode Implementation for AIOS
===================================================
Date: 2025-11-08
File: aio.py

USER PROBLEM IDENTIFIED
-----------------------
When running `aio jobs`, user had 20 worktrees in REVIEW status (19 from 4-7 days ago).
Pain points:
1. Manual review fatigue - no systematic way to review multiple worktrees
2. Forgetting tmux commands (Ctrl+B D to detach)
3. No context when entering a worktree
4. Decision paralysis on what to do with each worktree
5. Time waste opening each individually

SOLUTION RESEARCH
-----------------
Analyzed similar tools:
- git rebase -i: Sequential review with clear current item
- GitHub PR review: Step-by-step with approve/reject
- docker system prune: Interactive cleanup with prompts
- VSCode Source Control: Easy commit/discard decisions

Common patterns: Sequential processing, clear context, simple choices, keyboard shortcuts

IMPLEMENTATION (Library Glue Approach)
---------------------------------------
Added `aio review` command that:
1. Uses get_worktrees_sorted_by_datetime() to get review list
2. Uses is_pane_receiving_output() to filter inactive worktrees
3. Uses subprocess.run() for all tmux operations
4. Uses remove_worktree() for deletion operations
5. Uses datetime.strptime() for age calculation

Code characteristics:
- 90 lines added (highly condensed from 130 original)
- 100% library function calls, no custom business logic
- Event-based (blocks on tmux attach), no polling
- Reuses existing functions: get_worktrees_sorted_by_datetime, get_session_for_worktree, is_pane_receiving_output, remove_worktree

CONSOLE OUTPUT EXAMPLE
----------------------
$ aio review

ðŸ“‹ Review Mode - 20 worktrees
============================================================

[1/20] canada-claude-20251031-223631-single
Age: 7d 22h

ðŸ’¡ Ctrl+B D = detach from tmux
Opening: /home/seanpatten/projects/aiosWorktrees/canada-claude-20251031-223631-single

[User reviews in tmux, then detaches]

ðŸŽ¯ Action:
1=push+delete  2=delete  3=keep  4=stop  v=vscode
Choice: v
âœ“ Opened in VSCode
Choice: 2
âœ“ Removed git worktree
âœ“ Deleted branch: wt-canada-claude-20251031-223631-single
âœ“ Deleted directory: /home/seanpatten/projects/aiosWorktrees/canada-claude-20251031-223631-single

[2/20] aspirerates-codex-20251031-230747-multi-0
Age: 7d 21h
...

OPTIMIZATIONS MADE
------------------
1. Simplified from 130 lines to 90 lines (30% reduction)
2. Removed redundant confirmation prompts (already in remove_worktree)
3. Combined VSCode option into action menu (single loop)
4. Simplified session naming (review-0, review-1, etc)
5. Removed unnecessary time.sleep() delays
6. Used direct library calls for all operations
7. Simplified age display (Xd Yh format)
8. Made choices more concise (1/2/3/4/v instead of verbose menus)

PERFORMANCE
-----------
- Faster: No polling, direct tmux attach blocks efficiently
- Simpler: Single input loop per worktree
- Library-focused: 100% library function usage
- Readable: Clear, concise output and prompts

INTEGRATION
-----------
- Added to main command handling (line 2048)
- Updated help text in two places (lines 1476, 1543)
- No changes to existing functions needed
- Works with all existing worktree management infrastructure

USER BENEFITS
-------------
1. Systematic review of all pending worktrees
2. Clear reminder of tmux detach command
3. VSCode integration for detailed review
4. Simple numbered choices
5. Batch processing capability
6. Time-saving sequential workflow